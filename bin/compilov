#!/usr/bin/perl

$CC = $ENV{CC};
$rootlib = `pwd`; chomp($rootlib);

if (! $CC) {
print "No compiler in CC variable, searching one\n";
`bin/compilo_CCv`;  if ($? == 0) { print "CC  detected\n"; $CC = "CC";  }
`bin/compilo_g++v`; if ($? == 0) { print "g++ detected\n"; $CC = "g++"; }
`cxx -V`; if ($? == 0) { print "cxx detected\n"; $CC = "cxx"; }
}

if (! $CC) { die "No compiler found, aborting\n"; }
else { print "$CC is selected, version:\n"; } 

if ($CC =~ /CC/) {
  $rep = `bin/compilo_CCv`;
  print "$rep\n";
  print "Options:\n";
  print "COMP = CC\n";
  print "OPTIONS_STANDARD = \n";
  print "OPTIONS_STRICT = -LANG:std \n";
  print "OPTIONS_DEBUG    = -g\n";
  print "OPTIONS_OPTIMIZE = -O3\n";
  print "OPTIONS_BOTH     = -g3\n";
}
elsif ($CC =~ /cxx/) {
  $rep = `cxx -V`;
  print "$rep\n";
  print "Options:\n";
  print "COMP = cxx\n";
  print "OPTIONS_STANDARD = -ptr $rootlib/cxx_repository\n";
  print "OPTIONS_STRICT = -std strict_ansi -std strict_ansi_errors\n";
  print "OPTIONS_DEBUG    = -g\n";
  print "OPTIONS_OPTIMIZE = -O3\n";
  print "OPTIONS_BOTH     = -g3\n";
}
elsif ($CC =~ /g\+\+/) {
  $rep = `bin/compilo_g++v`;
  print "$rep\n";
  print "Options:\n";
  print "COMP = g++\n";
  print "OPTIONS_STANDARD = -ftemplate-depth-40\n";
  print "OPTIONS_STRICT = -pedantic\n";
  print "OPTIONS_DEBUG    = -g\n";
  print "OPTIONS_OPTIMIZE = -O3\n";
  print "OPTIONS_BOTH     = -g -O3\n";
}
else { 
  print "unrecognized, default options chosen\n"; 
  print "Options:\n";
  print "COMP = $CC\n";
  print "OPTIONS_STANDARD = \n";
  print "OPTIONS_STRICT = \n";
  print "OPTIONS_DEBUG    = -g\n";
  print "OPTIONS_OPTIMIZE = -O3\n";
  print "OPTIONS_BOTH     = -g -03\n";

}
